{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from\"react\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Image from\"react-native-web/dist/exports/Image\";import TextInput from\"react-native-web/dist/exports/TextInput\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import SectionList from\"react-native-web/dist/exports/SectionList\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import AsyncStorage from'@react-native-async-storage/async-storage';import Button from\"react-native-web/dist/exports/Button\";import{timeoutPromise,getWeatherTab,refreshToken,getRaceList}from\"./tools\";import Table from\"./Table\";var NewHelpScreen=function(_React$Component){_inherits(NewHelpScreen,_React$Component);var _super=_createSuper(NewHelpScreen);function NewHelpScreen(props){var _this;_classCallCheck(this,NewHelpScreen);_this=_super.call(this,props);_this.getRaceID=function(event){var id=event.target.value;AsyncStorage.setItem(\"raceIDHelper\",event.target.value);_this.saveRaceIDinState();};_this.changeLogout=function(event){event.preventDefault();_this.props.navigation.replace('Logout');};_this.handleSubmit=function(event){event.preventDefault();_this.sendNewWeatherRequest(_this.state.temp_air,_this.state.temp_ground,_this.state.weather_des);};_this.state={temp_ground:0.0,temp_air:0.0,weather_des:\"\",datetime:\"\",raceList:[],dataWeather:[],time:{},seconds:1800,raceid:0};_this.timer=0;_this.startTimer=_this.startTimer.bind(_assertThisInitialized(_this));_this.countDown=_this.countDown.bind(_assertThisInitialized(_this));return _this;}_createClass(NewHelpScreen,[{key:\"secondsToTime\",value:function secondsToTime(secs){var hours=Math.floor(secs/(60*60));var divisor_for_minutes=secs%(60*60);var minutes=Math.floor(divisor_for_minutes/60);var divisor_for_seconds=divisor_for_minutes%60;var seconds=Math.ceil(divisor_for_seconds);var obj={\"h\":hours,\"m\":minutes,\"s\":seconds};return obj;}},{key:\"startTimer\",value:function startTimer(){if(this.timer==0&&this.state.seconds>0){this.timer=setInterval(this.countDown,1000);}}},{key:\"countDown\",value:function countDown(){var seconds=this.state.seconds-1;this.setState({time:this.secondsToTime(seconds),seconds:seconds});if(seconds==0){clearInterval(this.timer);}}},{key:\"saveRaceIDinState\",value:function saveRaceIDinState(){var id;return _regeneratorRuntime.async(function saveRaceIDinState$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"raceIDHelper\"));case 2:id=_context.sent;this.setState({raceid:id});console.log(this.state.raceid);this.getWeatherData(id);case 6:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"getWeatherData\",value:function getWeatherData(raceID){var _this2=this;var accesstoken;return _regeneratorRuntime.async(function getWeatherData$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(AsyncStorage.getItem('accesstoken'));case 2:accesstoken=_context2.sent;console.log(raceID);console.log(accesstoken);getWeatherTab(accesstoken,raceID).then(function(DataTabular){console.log(DataTabular);_this2.setState({dataWeather:DataTabular});}).catch(function(error){console.log(error);});case 6:case\"end\":return _context2.stop();}}},null,null,null,Promise);}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var timeLeftVar,accesstoken;return _regeneratorRuntime.async(function componentDidMount$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:timeLeftVar=this.secondsToTime(this.state.seconds);this.setState({time:timeLeftVar});_context3.next=4;return _regeneratorRuntime.awrap(AsyncStorage.getItem('accesstoken'));case 4:accesstoken=_context3.sent;getRaceList(accesstoken).then(function(racelistDropdown){console.log(racelistDropdown);_this3.setState({raceList:racelistDropdown});}).catch(function(error){console.log(error);});case 6:case\"end\":return _context3.stop();}}},null,this,null,Promise);}},{key:\"validateForm\",value:function validateForm(){return this.state.weather_des.length>0&&this.state.raceid!=0;}},{key:\"sendNewWeatherRequest\",value:function sendNewWeatherRequest(temp_air,temp_ground,weather_des){var id;return _regeneratorRuntime.async(function sendNewWeatherRequest$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(temp_air);_context4.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"raceIDHelper\"));case 3:id=_context4.sent;timeoutPromise(2000,fetch('https://api.race24.cloud/user/weather/create',{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({raceID:id,temp_air:parseFloat(temp_air),temp_ground:parseFloat(temp_ground),weather_des:weather_des})})).then(function(response){return response.json();}).then(console.log(\"success\")).catch(function(error){console.log(error);});case 5:case\"end\":return _context4.stop();}}},null,null,null,Promise);}},{key:\"render\",value:function render(){var _this4=this;var optionTemplate=this.state.raceList.map(function(v){return React.createElement(\"option\",{value:v.id,key:v.id},v.name);});window.addEventListener('load',function(){setTimeout(function(){var select=document.getElementById('option');select.options.selectedIndex=0;select.dispatchEvent(new Event('change',{bubbles:true}));},1000);});var styles={container:{flex:1,flexDirection:'row',justifyContent:'space-around'},containerChild1:{alignItems:'center',backgroundColor:'grey',width:350},containerChild2:{textAlign:'center',marginLeft:'auto',marginRight:'auto'}};return React.createElement(View,{style:styles.container},React.createElement(View,{style:styles.containerChild1},React.createElement(Text,{style:{fontSize:30,color:'white',fontWeight:'bold',marginBottom:30,marginTop:30,fontfamily:'arial'}},\"Wetterdaten\"),React.createElement(\"label\",{style:{textAlign:'center',fontFamily:'arial',color:'white'}},\"Rennen:\",React.createElement(\"select\",{id:\"option\",style:{margin:10,fontFamily:'arial'},value:this.state.id,onChange:this.getRaceID},optionTemplate)),React.createElement(\"div\",{className:\"test\"},React.createElement(\"button\",{onClick:this.startTimer,style:{borderRadius:10,margin:10,marginBottom:30,fontFamily:'arial'}},\"Start\"),React.createElement(Text,{style:{fontfamily:'arial',color:'white'}},\" \",this.state.time.m,\" Minuten : \",this.state.time.s,\" Sekunden \")),React.createElement(\"label\",{style:{color:'white',fontFamily:'arial'}},\"Lufttemperatur\"),React.createElement(TextInput,{style:{backgroundColor:'white',borderRadius:10,width:200,height:40,margin:15,textAlign:'center'},placeholder:\"xx.xx\",onChangeText:function onChangeText(text){return _this4.setState({temp_air:parseFloat(text.trim())});}}),React.createElement(Text,null,\" \"),React.createElement(\"label\",{style:{color:'white',fontFamily:'arial'}},\"Streckentemperatur\"),React.createElement(TextInput,{style:{backgroundColor:'white',borderRadius:10,width:200,height:40,margin:15,textAlign:'center'},placeholder:\"xx.xx\",onChangeText:function onChangeText(text){return _this4.setState({temp_ground:parseFloat(text.trim())});}}),React.createElement(Text,null,\" \"),React.createElement(\"label\",{style:{color:'white',fontFamily:'arial'}},\"Streckenverh\\xE4ltnis\"),React.createElement(TextInput,{style:{backgroundColor:'white',borderRadius:10,width:200,height:40,marginBottom:35,margin:15,textAlign:'center'},placeholder:\"nass/trocken/bew\\xF6lkt\",onChangeText:function onChangeText(text){return _this4.setState({weather_des:text});}}),React.createElement(View,{style:{width:200}},React.createElement(Text,null,\" \"),React.createElement(Button,{title:\"Daten abspeichern\",disabled:!this.validateForm(),onPress:this.handleSubmit}),React.createElement(Text,null,\" \"),React.createElement(Text,null,\" \"),React.createElement(Button,{title:\"Logout\",onPress:this.changeLogout}))),React.createElement(ScrollView,{style:styles.containerChild2},React.createElement(Table,{list:this.state.dataWeather})));}}]);return NewHelpScreen;}(React.Component);export{NewHelpScreen as default};","map":{"version":3,"sources":["/home/toni/PycharmProjects/PropraSource/frontend/HelperScreen.js"],"names":["React","AsyncStorage","timeoutPromise","getWeatherTab","refreshToken","getRaceList","Table","NewHelpScreen","props","getRaceID","event","id","target","value","setItem","saveRaceIDinState","changeLogout","preventDefault","navigation","replace","handleSubmit","sendNewWeatherRequest","state","temp_air","temp_ground","weather_des","datetime","raceList","dataWeather","time","seconds","raceid","timer","startTimer","bind","countDown","secs","hours","Math","floor","divisor_for_minutes","minutes","divisor_for_seconds","ceil","obj","setInterval","setState","secondsToTime","clearInterval","getItem","console","log","getWeatherData","raceID","accesstoken","then","DataTabular","catch","error","timeLeftVar","racelistDropdown","length","fetch","method","headers","body","JSON","stringify","parseFloat","response","json","optionTemplate","map","v","name","window","addEventListener","setTimeout","select","document","getElementById","options","selectedIndex","dispatchEvent","Event","bubbles","styles","container","flex","flexDirection","justifyContent","containerChild1","alignItems","backgroundColor","width","containerChild2","textAlign","marginLeft","marginRight","fontSize","color","fontWeight","marginBottom","marginTop","fontfamily","fontFamily","margin","borderRadius","m","s","height","text","trim","validateForm","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n    View,\n    Text,\n    Image,\n    TextInput,\n    TouchableHighlight,\n    SectionList,\n    TouchableOpacity,\n    ScrollView,\n} from 'react-native';\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport {Button} from \"react-native-web\";\n//import {Button, Text, TextInput, ToastAndroid, View} from \"react-native\";\n\nimport {timeoutPromise,getWeatherTab, refreshToken,getRaceList} from \"./tools\";\nimport Table from \"./Table\";\n\nexport default class NewHelpScreen extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            temp_ground: 0.0,\n            temp_air: 0.0,\n            weather_des: \"\",\n            datetime: \"\",\n            raceList: [],\n            dataWeather: [],\n            time: {},\n            seconds: 1800,\n            raceid:0,\n        }\n\n        this.timer = 0;\n        this.startTimer = this.startTimer.bind(this);\n        this.countDown = this.countDown.bind(this);\n\n    }\n\n    secondsToTime(secs){\n        let hours = Math.floor(secs / (60 * 60));\n        let divisor_for_minutes = secs % (60 * 60);\n        let minutes = Math.floor(divisor_for_minutes / 60);\n        let divisor_for_seconds = divisor_for_minutes % 60;\n        let seconds = Math.ceil(divisor_for_seconds);\n        let obj = {\n          \"h\": hours,\n          \"m\": minutes,\n          \"s\": seconds\n        };\n        return obj;\n    }\n\n    startTimer() {\n        if (this.timer == 0 && this.state.seconds > 0) {\n            this.timer = setInterval(this.countDown, 1000);\n            }\n    }\n    countDown() {\n        let seconds = this.state.seconds - 1;\n        this.setState({\n            time: this.secondsToTime(seconds),\n            seconds: seconds,\n            });\n        // Check if  zero.\n      if (seconds == 0) {\n          clearInterval(this.timer);\n          }\n      }\n\n\n\n    async saveRaceIDinState(){\n        const id = await AsyncStorage.getItem(\"raceIDHelper\");\n        this.setState({raceid : id} );\n        console.log(this.state.raceid);\n        this.getWeatherData(id);\n    }\n\n     getRaceID = event =>{\n        const id = event.target.value;\n        AsyncStorage.setItem(\"raceIDHelper\",event.target.value);\n        this.saveRaceIDinState();\n    }\n\n\n    async getWeatherData(raceID){\n       const accesstoken = await AsyncStorage.getItem('accesstoken');\n       //const raceID = await AsyncStorage.getItem('raceID');\n       console.log(raceID);\n       console.log(accesstoken);\n       getWeatherTab(accesstoken, raceID).then(DataTabular => {\n                console.log(DataTabular);\n                this.setState({dataWeather: DataTabular});\n            }).catch(function (error) {\n                console.log(error);\n            })\n    }\n\n    async componentDidMount() {\n        let timeLeftVar = this.secondsToTime(this.state.seconds);\n        this.setState({ time: timeLeftVar });\n        const accesstoken = await AsyncStorage.getItem('accesstoken');\n        getRaceList(accesstoken).then(racelistDropdown => {\n            console.log(racelistDropdown);\n            this.setState({raceList: racelistDropdown});\n        }).catch(function (error) {\n            console.log(error);\n        });\n        }\n\n\n    changeLogout = event => {\n        event.preventDefault();\n        this.props.navigation.replace('Logout');\n    }\n\n\n    validateForm() {\n        return this.state.weather_des.length > 0 && this.state.raceid != 0 ;\n    }\n    handleSubmit = event => {\n        event.preventDefault();\n        this.sendNewWeatherRequest(this.state.temp_air,this.state.temp_ground,\n            this.state.weather_des);\n    }\n\n\n    async sendNewWeatherRequest(temp_air,temp_ground,weather_des) {\n        console.log(temp_air)\n        const id = await AsyncStorage.getItem(\"raceIDHelper\");\n       timeoutPromise(2000, fetch(\n            'https://api.race24.cloud/user/weather/create', {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    raceID:id,\n                    temp_air: parseFloat(temp_air),\n                    temp_ground: parseFloat(temp_ground),\n                    weather_des: weather_des,\n                })\n            })\n            ).then(response => response.json()).then(\n                console.log(\"success\")\n                ).catch(function (error) {\n                console.log(error);\n            })\n    }\n\n\n    render() {\n        let optionTemplate = this.state.raceList.map(v => (\n            <option value={v.id} key={v.id}>{v.name}</option>\n\n    ));\n\n\n    window.addEventListener('load', function() {\n        setTimeout(function()\n        {\n            let select = document.getElementById('option');\n            select.options.selectedIndex = 0;\n            select.dispatchEvent(new Event('change', {bubbles: true}));\n        }, 1000); // TODO - MÖGLICHST AUF DIESE UMSETZUNGSWEISE VERZICHTEN\n    })\n\n    const styles = {\n\n        container: {\n        flex: 1,\n        flexDirection: 'row',\n            justifyContent: 'space-around'\n        },\n\n        containerChild1: {\n        alignItems: 'center',\n        backgroundColor: 'grey',\n        width: 350,\n        },\n\n        containerChild2: {\n        textAlign: 'center',\n            marginLeft: 'auto',\n            marginRight: 'auto',\n        },\n    };\n\n        return (\n          <View style={styles.container}>\n\n            <View style={styles.containerChild1}>\n\n              <Text style={{fontSize: 30, color:'white', fontWeight: 'bold', marginBottom: 30, marginTop: 30, fontfamily: 'arial'}}>Wetterdaten</Text>\n\n              <label style={{textAlign: 'center', fontFamily: 'arial', color: 'white'}}>Rennen:\n              <select id='option' style={{margin: 10, fontFamily: 'arial'}} value={this.state.id} onChange={this.getRaceID}>{optionTemplate}</select>\n              </label>\n\n              <div className='test'>\n              <button onClick={this.startTimer} style={{borderRadius: 10, margin: 10, marginBottom: 30, fontFamily: 'arial'}}>Start</button>\n                  <Text style={{fontfamily: 'arial', color: 'white'}}> {this.state.time.m} Minuten : {this.state.time.s} Sekunden </Text>\n              </div>\n\n              <label style={{color: 'white',  fontFamily: 'arial'}}>Lufttemperatur</label>\n              <TextInput\n              style = {{backgroundColor: 'white', borderRadius: 10, width: 200, height: 40, margin: 15, textAlign: 'center'}}\n              placeholder=\"xx.xx\"\n              onChangeText={(text) => this.setState({temp_air:parseFloat(text.trim())})}\n              />\n                 <Text> </Text>\n              <label style={{color: 'white',  fontFamily: 'arial'}}>Streckentemperatur</label>\n              <TextInput\n              style = {{backgroundColor: 'white', borderRadius: 10, width: 200, height: 40, margin: 15, textAlign: 'center'}}\n              placeholder=\"xx.xx\"\n              onChangeText={(text) => this.setState( {temp_ground:parseFloat(text.trim())})}\n              />\n                <Text> </Text>\n              <label style={{color: 'white',  fontFamily: 'arial'}}>Streckenverhältnis</label>\n              <TextInput\n              style = {{backgroundColor: 'white', borderRadius: 10, width: 200, height: 40, marginBottom: 35, margin: 15, textAlign: 'center'}}\n              placeholder=\"nass/trocken/bewölkt\"\n              onChangeText={(text) => this.setState({weather_des:text})}\n              />\n                <View style={{width: 200}}>\n                    <Text> </Text>\n              <Button\n              title=\"Daten abspeichern\"\n              disabled={!this.validateForm()}\n              onPress={this.handleSubmit}\n              />\n                <Text> </Text>\n                 <Text> </Text>\n             <Button\n                title='Logout'\n                onPress={this.changeLogout}\n                />\n                </View>\n            </View>\n\n            <ScrollView style={styles.containerChild2}>\n\n              <Table list={this.state.dataWeather}/>\n\n            </ScrollView>\n\n          </View>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}